// Module included in the following assemblies:
//
// assembly-upgrade-resources.adoc

[id='proc-upgrade-cli-tool-files-{context}']
= Converting custom resources configuration files using the API conversion tool

[role="_abstract"]
This procedure describes how to use the API conversion tool to convert YAML files describing the configuration for Strimzi custom resources into a format applicable to `{ApiVersion}`.
To do so, you use the `convert-file` (`cf`) command.

The command can convert YAML files containing multiple documents.
For a multi-document YAML file, all the Strimzi custom resources it contains are converted.
Any non-Strimzi Kubernetes resources are replicated unmodified in the converted output file.

After you have converted the YAML file, you can apply the configuration to update the custom resource in the cluster.
Alternatively, if the GitOps synchronization mechanism is being used for updates on your cluster, you can use it to apply the changes.

.Prerequisites

* A Cluster Operator supporting the `{ApiVersion}` API version is up and running.
* The API conversion tool, which is provided with the release artifacts.

Use the CLI help for more information on the API conversion tool, and the flags available for the `convert-file` command:

[source,shell]
----
bin/api-conversion.sh help
bin/api-conversion.sh help convert-file
----

.Flags for YAML file conversion
[cols="2*",options="header",stripes="none"]
|===

|Flag
|Description

|`-f`, `--file=_NAME-OF-YAML-FILE_`
|Specifies the YAML file for the Strimzi custom resource being converted

|`-o,` `--output=_NAME-OF-CONVERTED-YAML-FILE_`
|Creates an output YAML file for the converted custom resource

|`--in-place`
|Writes the converted YAML into the original source file

|`-ll`, `--log-level=<level>`
|Sets the log level to enable logging

|`-d`, `--debug`
|Runs the tool in debug mode

|===

.Procedure

. Run the API conversion tool with the appropriate command and flags.
+
Example 1, converts a YAML file and displays the output:
+
[source,shell]
----
bin/api-conversion.sh convert-file --file input.yaml
----
+
Example 2, converts a YAML file, and writes the changes into the original source file:
+
[source,shell]
----
bin/api-conversion.sh convert-file --file input.yaml --in-place
----
+
Example 3, converts a YAML file, and writes the changes into a new output file:
+
[source,shell]
----
bin/api-conversion.sh convert-file --file input.yaml --output output.yaml
----

. Update the custom resources using the converted configuration file.
+
[source,shell,subs=+quotes]
kubectl apply -f _CONVERTED-CONFIG-FILE_
